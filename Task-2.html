<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>India — Fossil Fuel Availability (Power BI style)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --text:#e6eef8; --accent:#60a5fa;
      --accent2:#34d399; --danger:#fb7185;
    }
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#08101a);color:var(--text);}
    .container{max-width:1200px;margin:20px auto;padding:18px;}
    .header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;font-size:20px;letter-spacing:-0.3px}
    .sub{color:var(--muted);font-size:13px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); border-radius:12px;padding:14px;box-shadow:0 10px 30px rgba(2,6,23,0.6);}
    .grid{display:grid;grid-template-columns:1fr 420px;gap:16px;margin-top:16px}
    .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    select,input{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:8px 10px;border-radius:8px}
    .small{font-size:13px;color:var(--muted)}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{padding:8px 6px;text-align:right;border-bottom:1px solid rgba(255,255,255,0.03);font-size:13px}
    th:first-child,td:first-child{text-align:left}
    .row{display:flex;gap:12px;align-items:center}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pill{background:rgba(96,165,250,0.12);color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px;border:1px solid rgba(96,165,250,0.2)}
    .sources{margin-top:12px;font-size:13px;color:var(--muted)}
    .download{background:linear-gradient(90deg,var(--accent),var(--accent2));border:none;color:#022;cursor:pointer;padding:8px 12px;border-radius:8px;font-weight:700}
    .footer{margin-top:14px;color:var(--muted);font-size:13px}
    @media (max-width:980px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <div class="pill">Official sources: MOSPI, IEA, EIA</div>
        <h1>India — Estimated Fossil Fuel Availability</h1>
        <div class="sub">Reserves, consumption, and how many years each fuel would last at current consumption (simple reserve ÷ consumption)</div>
      </div>
      <div class="controls">
        <div class="small">As of: <strong>Data snapshots used — Reserves (MOSPI: 01‑04‑2024 / 01‑04‑2023), Consumption (IEA / EIA 2023)</strong></div>
      </div>
    </div>

    <div class="grid" style="margin-top:18px">
      <div class="card">
        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
          <div>
            <div class="small">Interactive visualization</div>
            <h2 style="margin:6px 0 2px">Years remaining by fuel</h2>
            <div class="small">Simple years remaining = <em>Reserve ÷ Annual consumption</em>. See sources below.</div>
          </div>
          <div style="text-align:right">
            <button class="download" id="downloadCsv">Download CSV</button>
            <div style="height:8px"></div>
            <div class="small">Share or embed this HTML — it's self-contained.</div>
          </div>
        </div>

        <div style="display:flex;gap:18px;margin-top:12px;align-items:flex-start;flex-wrap:wrap">
          <div style="flex:1;min-width:260px">
            <canvas id="barChart" height="160"></canvas>
          </div>
          <div style="width:260px">
            <canvas id="doughnutChart" height="220"></canvas>
            <div class="legend" id="legend"></div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div class="small">Interpretation:</div>
          <table>
            <thead><tr><th>Fuel</th><th>Reserve (unit)</th><th>Annual use</th><th>Years left</th><th>Note</th></tr></thead>
            <tbody id="dataBody"></tbody>
          </table>
        </div>

        <div class="sources">
          <strong>Sources:</strong>
          <ul>
            <li>MOSPI — <em>Energy Statistics India 2025</em> (reserves & resource tables). PDF: https://mospi.gov.in/sites/default/files/publication_reports/Energy_Statistics_2025/Energy%20Statistics%20India%202025_27032025.pdf</li>
            <li>IEA — Coal 2024 (India consumption): https://www.iea.org/reports/coal-2024</li>
            <li>EIA — India oil consumption (2023): https://www.eia.gov/todayinenergy/detail.php?id=64084</li>
            <li>IEA — India gas market report (2023): https://www.iea.org/reports/india-gas-market-report/executive-summary</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div class="small">Data control</div>
        <h3 style="margin:6px 0">Adjust view</h3>
        <div style="display:flex;flex-direction:column;gap:8px">
          <label class="small">Show units:</label>
          <select id="unitSelect">
            <option value="years">Years remaining (default)</option>
            <option value="reserve">Reserve (raw)</option>
            <option value="consumption">Annual consumption</option>
          </select>

          <label class="small">Sort by:</label>
          <select id="sortSelect">
            <option value="fuel">Fuel name</option>
            <option value="years_desc">Years (high → low)</option>
            <option value="years_asc">Years (low → high)</option>
            <option value="reserve_desc">Reserve (high → low)</option>
          </select>

          <label class="small">Scenario:</label>
          <select id="scenarioSelect">
            <option value="base">Base (official snapshots)</option>
            <option value="proved_coal">Coal — use proved recoverable = 10% of resource (example)</option>
            <option value="increased_consumption">Higher consumption (+3% growth annually) — static calc for illustration</option>
          </select>

          <div class="small" style="margin-top:6px">Note: Scenario options are illustrative. The base scenario uses official MOSPI/IEA/EIA numbers listed in the table and Sources.</div>
        </div>
      </div>
    </div>

    <div class="footer card" style="margin-top:16px">
      <div><strong>Methodology (brief)</strong></div>
      <ol class="small">
        <li>Years remaining = Reserve / Annual consumption (units matched in table).</li>
        <li>Coal reserve used here is total geological resource reported by MOSPI/GSI (large). For conservative planning, use only proved recoverable.</li>
        <li>Consumption figures are annual totals for 2023 reported by IEA / EIA; convert units where needed.</li>
      </ol>
    </div>
  </div>

<script>
// Embedded official data (values used in calculations)
// Units: Coal & Oil in Million tonnes (Mt); Gas in billion cubic metres (bcm)
// Reserve_value and Annual_consumption_value match units shown.
const DATA = [
  {
    fuel: "Coal",
    reserve_unit: "Million tonnes (Mt)",
    reserve_value: 389420.0, // 389.42 billion tonnes -> 389,420 Mt
    consumption_unit: "Million tonnes per year (Mt/yr)",
    consumption_value: 1245.0,
    source_note: "GSI/MOSPI (01-04-2024); IEA Coal 2024 (2023 consumption)"
  },
  {
    fuel: "Crude oil (domestic)",
    reserve_unit: "Million tonnes (Mt)",
    reserve_value: 671.40,
    consumption_unit: "Million tonnes per year (Mt/yr)",
    consumption_value: 263.9, // EIA 5.3 mb/d -> ~263.9 Mt/yr
    source_note: "MOSPI (01-04-2024 reserves); EIA (2023 consumption)"
  },
  {
    fuel: "Natural gas",
    reserve_unit: "Billion cubic metres (bcm)",
    reserve_value: 1149.46,
    consumption_unit: "Billion cubic metres per year (bcm/yr)",
    consumption_value: 65.0,
    source_note: "MOSPI (01-04-2023 reserves); IEA gas report (2023 consumption)"
  }
];

function computeYears(entry) {
  if (!entry || !entry.reserve_value || !entry.consumption_value) return null;
  return entry.reserve_value / entry.consumption_value;
}

function rounded(v) { return (Math.round(v*100)/100); }

// Prepare table body
function buildTable(dataArr) {
  const tbody = document.getElementById('dataBody');
  tbody.innerHTML = '';
  dataArr.forEach(d => {
    const years = computeYears(d);
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${d.fuel}</td>
      <td style="text-align:right">${d.reserve_value.toLocaleString()} ${d.reserve_unit}</td>
      <td style="text-align:right">${d.consumption_value.toLocaleString()} ${d.consumption_unit}</td>
      <td style="text-align:right">${years!==null?rounded(years):''}</td>
      <td style="text-align:left">${d.source_note}</td>`;
    tbody.appendChild(tr);
  });
}

// Create charts
let barChart=null, doughnutChart=null;
function renderCharts(dataArr, unitMode='years') {
  const labels = dataArr.map(d=>d.fuel);
  const yearsVals = dataArr.map(d => computeYears(d));
  const reserveVals = dataArr.map(d=>d.reserve_value);
  const consVals = dataArr.map(d=>d.consumption_value);

  const barCtx = document.getElementById('barChart').getContext('2d');
  if (barChart) barChart.destroy();
  const barData = {
    labels,
    datasets: [{
      label: unitMode==='years' ? 'Years remaining' : unitMode==='reserve' ? 'Reserve (raw)' : 'Annual consumption',
      data: unitMode==='years' ? yearsVals.map(v=>rounded(v)) : (unitMode==='reserve' ? reserveVals : consVals),
      backgroundColor: ['#60A5FA','#FBBF24','#34D399'],
      borderRadius:6,
      barThickness:36
    }]
  };
  barChart = new Chart(barCtx, {
    type:'bar',
    data: barData,
    options:{
      responsive:true,
      plugins:{legend:{display:false}, tooltip:{callbacks:{label:ctx=> ctx.dataset.label+': '+ctx.parsed.y}}},
      scales:{y:{beginAtZero:true}, x:{ticks:{color:'#cfe8ff'}}}
    }
  });

  // Doughnut: Years share (normalized)
  if (doughnutChart) doughnutChart.destroy();
  const doughCtx = document.getElementById('doughnutChart').getContext('2d');
  const norm = yearsVals.map(v=> v!=null? v : 0);
  doughnutChart = new Chart(doughCtx, {
    type: 'doughnut',
    data:{
      labels,
      datasets:[{data:norm, backgroundColor:['#60A5FA','#FBBF24','#34D399']}]
    },
    options:{responsive:true,plugins:{legend:{display:false}}}
  });

  // legend
  const legend = document.getElementById('legend');
  legend.innerHTML = '';
  labels.forEach((lbl,i)=>{
    const el = document.createElement('div');
    el.style.display='inline-flex'; el.style.alignItems='center'; el.style.gap='8px';
    el.innerHTML = `<span style="display:inline-block;width:12px;height:12px;background:${['#60A5FA','#FBBF24','#34D399'][i]};border-radius:3px"></span><span class="small">${lbl}</span>`;
    legend.appendChild(el);
  });
}

// CSV download
function downloadCSV(dataArr) {
  const headers = ['fuel','reserve_unit','reserve_value','consumption_unit','consumption_value','years_remaining','source_note'];
  const rows = dataArr.map(d=>{
    const years = computeYears(d);
    return [d.fuel, d.reserve_unit, d.reserve_value, d.consumption_unit, d.consumption_value, years!==null?rounded(years):'', `"${d.source_note}"`].join(',');
  });
  const csv = [headers.join(','), ...rows].join('\n');
  const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'india_fossil_availability.csv';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

// Scenario handling (simple illustrative scenarios)
function applyScenario(scenario) {
  // deep copy of DATA
  const arr = JSON.parse(JSON.stringify(DATA));
  if (scenario==='proved_coal') {
    // assume proved recoverable = 10% of resource (illustrative conservative)
    arr.forEach(d=>{ if (d.fuel==='Coal') d.reserve_value = d.reserve_value * 0.10; });
  } else if (scenario==='increased_consumption') {
    // increase consumption by 20% (static)
    arr.forEach(d=>{ d.consumption_value = d.consumption_value * 1.20; });
  }
  return arr;
}

// UI wiring
document.getElementById('unitSelect').addEventListener('change', ()=>{
  const unit = document.getElementById('unitSelect').value;
  const scenario = document.getElementById('scenarioSelect').value;
  const arr = applyScenario(scenario);
  buildTable(arr);
  renderCharts(arr, unit);
});

document.getElementById('sortSelect').addEventListener('change', ()=>{
  const mode = document.getElementById('sortSelect').value;
  let arr = applyScenario(document.getElementById('scenarioSelect').value);
  if (mode==='years_desc') arr.sort((a,b)=> computeYears(b)-computeYears(a));
  else if (mode==='years_asc') arr.sort((a,b)=> computeYears(a)-computeYears(b));
  else if (mode==='reserve_desc') arr.sort((a,b)=> b.reserve_value - a.reserve_value);
  buildTable(arr);
  renderCharts(arr, document.getElementById('unitSelect').value);
});

document.getElementById('scenarioSelect').addEventListener('change', ()=>{
  const scenario = document.getElementById('scenarioSelect').value;
  const arr = applyScenario(scenario);
  buildTable(arr);
  renderCharts(arr, document.getElementById('unitSelect').value);
});

document.getElementById('downloadCsv').addEventListener('click', ()=>{
  const scenario = document.getElementById('scenarioSelect').value;
  const arr = applyScenario(scenario);
  downloadCSV(arr);
});

// Initialize
(function(){ buildTable(DATA); renderCharts(DATA,'years'); })();

</script>
</body>
</html>
